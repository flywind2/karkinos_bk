package jp.ac.utokyo.rcast.karkinos.annotation;

import java.io.IOException;

import jp.ac.utokyo.rcast.karkinos.utils.TwoBitGenomeReader;

import org.broad.igv.bbfile.BBFileReader;
import org.broad.igv.bbfile.BigWigIterator;
import org.broad.igv.bbfile.WigItem;

public class MappabilityAnnotation {
	
	String file = "";
	BBFileReader bbReader = null;
	boolean init = false;
	public MappabilityAnnotation(String s) throws IOException{
		if(s!=null){
		 file = s;
		 bbReader = new BBFileReader(s);
		 init = true;
		}
	}
	
	public boolean isInit() {
		return init;
	}

	public float getMappability(String chrom,int pos){
		
		float ret = -1;
		BigWigIterator bi = bbReader.getBigWigIterator(chrom, pos, chrom, pos, false);
		if(bi!=null&&bi.hasNext()){
			WigItem wig = bi.next();
			ret = wig.getWigValue();
		}
		return ret;
	}
	

}
